"use strict";
exports.__esModule = true;
var fs = require("fs");
var path = require("path");
var xlsx_1 = require("xlsx");
var usage = "usage: xls2csv filename";
var args = process.argv;
if (args.length !== 3) {
    console.error(usage);
    process.exit(1);
}
console.log("arg1="+args[1]+" arg2="+args[2]);

var filename = args[2];
var baseOutFilename = filename.replace(/\.[^/.]+$/, "");
var workbook = xlsx_1.readFile(path.join(process.cwd(), filename));
for (var _i = 0, _a = workbook.SheetNames; _i < _a.length; _i++) {
    var sheetName = _a[_i];
    var sheet = workbook.Sheets[sheetName];
    var csv = xlsx_1.utils.sheet_to_csv(sheet).replace(/[,]{2,}/gm, "");
    var outFilename = workbook.SheetNames.length === 1
        ? baseOutFilename + ".csv"
        : baseOutFilename + "_" + sheetName + ".csv";
    fs.writeFile(path.join(process.cwd(), outFilename), csv, undefined, function () { });
}
